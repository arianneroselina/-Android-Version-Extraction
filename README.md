# Android Version Extraction

## Introduction
This repository is introduced in my Bachelor thesis with the title "Vulnerability Detection for Android Apps Using Version Information".
This tool automates the version extraction of an Android application (frameworks and languages used) and use this information
to determine the security and privacy vulnerabilities of the app.

Android mobile app development frameworks that are supported by this tool:
1. Flutter
2. React Native
3. Qt
4. Xamarin
5. Unity
6. Apache Cordova

## Usage
Given an APK file or folder path, this tool creates a JSON file stating the versions and the corresponding vulnerability website links.
The JSON file can be found in the same directory as the APK file.

### Two ways to run the tool
- Run directly using sbt.
    ````
    sbt
    ~run -f C:/path/to/apk/filename.apk 
    ````
  
- Run with a generated .jar file.
    ````
    sbt assembly // just once
    java -jar ./target/scala-2.13/android_version_extraction-assembly-0.1.0-SNAPSHOT.jar -f C:/path/to/apk/filename.apk 
    ````

### Available flags
- `-f <arg>` or `--apk-filepath <arg>` : input file \<apk file path\>
- `-d <arg>` or `--apk-files-directory <arg> ` : input files \<apk files directory path\>
- `-a` or `--android-general` : include Android security vulnerability links that apply to all versions

## Other Scripts

### Write File Hashes
This repository also includes [a python script](src/main/hashing/write_file_hashes.py) that can append a new hashed .lib/.dll file 
of the frameworks to the existing tables in [the hashes folder](src/files/hashes).
The hash in the tables will later be compared to the one given as an input.
If the hashes match, it means that they have the same version.
This method is used to extract Flutter, Qt, React Native, and Xamarin's versions.

### Extract Android CVE
A function to extract Android API CVE vulnerability links can also be found in 
[this python script](src/main/cve/extract_android_cve.py), which adds vulnerability links into the corresponding csv 
file in [the AndroidAPI folder](src/files/vulnerability_links/AndroidAPI).
The input for this script can be obtained by downloading a CVE page using the "Download Results" button and rename it to
a csv file.


## List of Files
Apart from the files generated by the [Write File Hashes](#write-file-hashes) and the 
[Extract Android CVE](#extract-android-cve) scripts, there are 4 additional files that contain the security vulnerability 
links of the frameworks, namely Cordova, Flutter, Qt and React Native.
These files were created manually using information I obtained from my own research.
