package vulnerability

import tools.VersionComparison.olderThanForUnity

import scala.collection.mutable.ArrayBuffer

object Unity {

  /**
   * Return a link about security vulnerabilities of the given Unity version.
   * Based on https://unity.com/security and
   * https://www.cvedetails.com/vulnerability-list/vendor_id-20176/Unity.html
   *
   * @param version the Unity version
   * @return the link
   */
  def getVulnerabilities(version: String): Array[String] = {
    val array = ArrayBuffer[String]()

    if (olderThanForUnity(version, "2020.2.0a11") > -1
      && (version != "2020.2.0a11" || version != "2020.1.0b9"
      || version != "2019.3.14f1"  || version != "2018.4.23f1"
      || version != "2017.4.40f1")) {
      array += "https://unity.com/security/unity-sec-2143#vulnerability-details--2"
    }
    if (olderThanForUnity(version, "2019.2.0a7") > -1
      && (version != "2019.2.0a7" || version != "2019.1.0b5"
      || version != "2018.3.7f1"  || version != "2018.2.21f1"
      || version != "2017.4.22f1" || version != "5.6.7f1")) {
      array += "https://unity.com/security/unity-sec-1291"
    }
    if (olderThanForUnity(version, "2017.2.0b8") > -1
      && (version != "2017.2.0b8" || version != "2017.1.0p4"
      || version != "5.6.3p1"  || version != "5.5.4p3"
      || version != "5.4.5p5" || version != "5.3.8p2")) {
      array += "https://unity.com/security/unity-sec-884"
    }
    if ((olderThanForUnity(version, "4.6.6f2") == 1)
      || (olderThanForUnity("5.0.0f0", version) > -1 && olderThanForUnity(version, "5.0.3f2") == 1)) {
      array += "https://www.cvedetails.com/cve/CVE-2020-17507/"
    }

    array.toArray
  }
}
