package vulnerability

import tools.VersionComparison.olderThan

object Flutter {

  /**
   * Return a link about security vulnerabilities of the given Flutter version.
   * Based on https://github.com/dart-lang/sdk/security/advisories
   *
   * @param version the Flutter version
   * @return the link
   */
  def getVulnerabilities(version: String): Array[String] = {
    val array = Array[String]()

    if (olderThan(version, "3.3.2") > -1) {
      array :+ "https://github.com/dart-lang/sdk/security/advisories/GHSA-m9pm-2598-57rj"
    }
    if (olderThan(version, "2.10.0") > -1) {
      array :+ "https://github.com/dart-lang/sdk/security/advisories/GHSA-c8mh-jj22-xg5h"
    }
    if (olderThan(version, "2.5.3") > -1) {
      array ++ Array("https://github.com/dart-lang/sdk/security/advisories/GHSA-8pcp-6qc9-rqmv",
        "https://github.com/dart-lang/sdk/security/advisories/GHSA-r32f-vhjp-qhj7")
    }
    if (olderThan(version, "2.0.4") > -1) {
      array :+ "https://github.com/dart-lang/sdk/security/advisories/GHSA-3rfv-4jvg-9522"
    }

    array
  }
}
