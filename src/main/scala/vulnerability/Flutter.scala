package vulnerability

import tools.VersionComparison.olderThan

import scala.collection.mutable.ArrayBuffer

object Flutter {

  /**
   * Return a link about security vulnerabilities of the given Flutter version.
   * Based on https://github.com/dart-lang/sdk/security/advisories
   *
   * @param version the Flutter version
   * @return the link
   */
  def getVulnerabilities(version: String): Array[String] = {
    val array = ArrayBuffer[String]()

    if (olderThan(version, "3.3.2") > -1) {
      array += "https://github.com/dart-lang/sdk/security/advisories/GHSA-m9pm-2598-57rj"
      array += "https://www.cvedetails.com/cve/CVE-2022-3095/"
    }
    if (olderThan(version, "2.10.0") > -1) {
      array += "https://github.com/dart-lang/sdk/security/advisories/GHSA-c8mh-jj22-xg5h"
      array += "https://www.cvedetails.com/cve/CVE-2022-0451/"
    }
    if (olderThan(version, "2.5.3") > -1) {
      array += "https://github.com/dart-lang/sdk/security/advisories/GHSA-8pcp-6qc9-rqmv"
      array += "https://www.cvedetails.com/cve/CVE-2021-22567/"
      array += "https://github.com/dart-lang/sdk/security/advisories/GHSA-r32f-vhjp-qhj7"
      array += "https://www.cvedetails.com/cve/CVE-2021-22568/"
    }
    if (olderThan(version, "2.0.4") > -1) {
      array += "https://github.com/dart-lang/sdk/security/advisories/GHSA-3rfv-4jvg-9522"
      array += "https://www.cvedetails.com/cve/CVE-2021-22540/"
    }

    array.toArray
  }
}
