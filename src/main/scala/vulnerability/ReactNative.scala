package vulnerability

import tools.VersionComparison.olderThan

import scala.collection.mutable.ArrayBuffer

object ReactNative {

  /**
   * Return a link about security vulnerabilities of the given React Native version.
   * Based on https://github.com/facebook/react-native/blob/main/CHANGELOG.md
   *
   * @param version the React Native version
   * @return the link
   */
  def getVulnerabilities(version: String): Array[String] = {
    val array = ArrayBuffer[String]()

    if (olderThan(version, "0.71.0") == 1) {
      array += "https://github.com/facebook/react-native/commit/1042a8012fb472bd5c882b469fe507dd6279d562"
      array += "https://github.com/advisories/GHSA-4wf5-vphf-c2xc"
      array += "https://github.com/advisories/GHSA-7627-mp87-jf6q"
      array += "https://github.com/facebook/react-native/commit/3da3d82320bd035c6bd361a82ea12a70dba4e851"
    }
    if (olderThan(version, "0.70.0") == 1) {
      array += "https://github.com/facebook/react-native/commit/3da3d82320bd035c6bd361a82ea12a70dba4e851"
      array += "https://github.com/advisories/GHSA-7627-mp87-jf6q"
    }
    if (olderThan(version, "0.69.0") == 1) {
      array += "https://github.com/facebook/react-native/commit/1042a8012fb472bd5c882b469fe507dd6279d562"
    }
    if (olderThan(version, "0.67.0") == 1) {
      array += "https://github.com/facebook/react-native/commit/e612d3a116f39ab354169643bab0d4bb9cfc1a85"
    }
    if (olderThan(version, "0.63.3") == 1) {
      array += "https://github.com/facebook/react-native/commit/001eb7cbd66c7dc1a302ee2a638c1cfc164538f4"
    }
    if ((olderThan("0.63.0", version) > -1 && olderThan(version, "0.64.1") == 1)
      || olderThan("0.59.0", version) > -1 && olderThan(version, "0.62.3") == 1) {
      array += "https://github.com/advisories/GHSA-7f53-fmmv-mfjv"
    }

    array.toArray
  }
}
