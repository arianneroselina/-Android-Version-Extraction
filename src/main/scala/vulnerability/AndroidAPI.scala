package vulnerability

object AndroidAPI {

  /**
   * Return a link about security vulnerabilities of the given Android version.
   * Based on https://www.cvedetails.com/vulnerability-list.php?vendor_id=1224&product_id=19997&version_id=&page=3&hasexp=0&opdos=0&opec=0&opov=0&opcsrf=0&opgpriv=0&opsqli=0&opxss=0&opdirt=0&opmemc=0&ophttprs=0&opbyp=0&opfileinc=0&opginf=0&cvssscoremin=0&cvssscoremax=0&year=0&month=0&cweid=0&order=1&trc=4902&sha=1bd76566e804bd0baf4aa6ef43598ed24565b5b6
   *
   * @param version the Android API version
   * @return the link
   */
  def getVulnerabilities(version: Int): Array[String] = {
    val array = Array[String]()

    // TODO
    if (version >= 29 && version <= 33) { // 29-33
      array ++ Array("https://www.cvedetails.com/cve/CVE-2022-39908/",
        "https://www.cvedetails.com/cve/CVE-2022-39907/",
        "https://www.cvedetails.com/cve/CVE-2022-39906/",
        "https://www.cvedetails.com/cve/CVE-2022-39905/",
        "https://www.cvedetails.com/cve/CVE-2022-39903/",
        "https://www.cvedetails.com/cve/CVE-2022-39899/",
        "https://www.cvedetails.com/cve/CVE-2022-39898/")
      if (version == 33) { // 33
        array ++ Array("https://www.cvedetails.com/cve/CVE-2022-42544/",
          "https://www.cvedetails.com/cve/CVE-2022-42542/",
          "https://www.cvedetails.com/cve/CVE-2022-42535/")
      } else { // 29-32
        array ++ Array("https://www.cvedetails.com/cve/CVE-2022-39904/",
          "https://www.cvedetails.com/cve/CVE-2022-39897/",
          "https://www.cvedetails.com/cve/CVE-2022-39896/",
          "https://www.cvedetails.com/cve/CVE-2022-39895/",
          "https://www.cvedetails.com/cve/CVE-2022-39894/",
          "https://www.cvedetails.com/cve/CVE-2022-39887/",
          "https://www.cvedetails.com/cve/CVE-2022-39885/",
          "https://www.cvedetails.com/cve/CVE-2022-39884/",
          "https://www.cvedetails.com/cve/CVE-2022-39883/",
          "https://www.cvedetails.com/cve/CVE-2022-39882/",
          "https://www.cvedetails.com/cve/CVE-2022-39855/",
          "https://www.cvedetails.com/cve/CVE-2022-39852/",
          "https://www.cvedetails.com/cve/CVE-2022-39851/",
          "https://www.cvedetails.com/cve/CVE-2022-39850/",
          "https://www.cvedetails.com/cve/CVE-2022-39848/",
          "https://www.cvedetails.com/cve/CVE-2022-39847/",
          "https://www.cvedetails.com/cve/CVE-2022-36863/",
          "https://www.cvedetails.com/cve/CVE-2022-36862/",
          "https://www.cvedetails.com/cve/CVE-2022-36861/",
          "https://www.cvedetails.com/cve/CVE-2022-36860/",
          "https://www.cvedetails.com/cve/CVE-2022-36858/",
          "https://www.cvedetails.com/cve/CVE-2022-36855/",
          "https://www.cvedetails.com/cve/CVE-2022-36854/",
          "https://www.cvedetails.com/cve/CVE-2022-36853/",
          "https://www.cvedetails.com/cve/CVE-2022-36849/",
          "https://www.cvedetails.com/cve/CVE-2022-36848/",
          "https://www.cvedetails.com/cve/CVE-2022-36846/",
          "https://www.cvedetails.com/cve/CVE-2022-36845/",
          "https://www.cvedetails.com/cve/CVE-2022-36844/",
          "https://www.cvedetails.com/cve/CVE-2022-36843/",
          "https://www.cvedetails.com/cve/CVE-2022-36842/",
          "https://www.cvedetails.com/cve/CVE-2022-36841/",
          "https://www.cvedetails.com/cve/CVE-2022-33729/",
          "https://www.cvedetails.com/cve/CVE-2022-33728/",
          "https://www.cvedetails.com/cve/CVE-2022-33727/",
          "https://www.cvedetails.com/cve/CVE-2022-33726/",
          "https://www.cvedetails.com/cve/CVE-2022-33724/")
        if (version > 29) { // 30-32
          array ++ Array("https://www.cvedetails.com/cve/CVE-2022-39880/",
            "https://www.cvedetails.com/cve/CVE-2022-39879/",
            "https://www.cvedetails.com/cve/CVE-2022-36868/",
            "https://www.cvedetails.com/cve/CVE-2022-36852/",
            "https://www.cvedetails.com/cve/CVE-2022-33731/")
          if (version == 30) { // 30
            array ++ Array("https://www.cvedetails.com/cve/CVE-2022-36857/")
          } else { // 31-32
            array ++ Array("https://www.cvedetails.com/cve/CVE-2022-39856/",
              "https://www.cvedetails.com/cve/CVE-2022-36856/",
              "https://www.cvedetails.com/cve/CVE-2022-36850/",
              "https://www.cvedetails.com/cve/CVE-2022-33732/",
              "https://www.cvedetails.com/cve/CVE-2022-33730/")
          }
        } else { // 29
          array ++ Array("https://www.cvedetails.com/cve/CVE-2022-36847/")
        }
        if (version < 31) { // 29-30
          array ++ Array("https://www.cvedetails.com/cve/CVE-2022-33725/")
        }
      }
      if (version > 29) { // 30-33
        array ++ Array("https://www.cvedetails.com/cve/CVE-2022-39900/")
      }
    }

    if (version >= 24 && version <= 28) { // 24-28
      array ++ Array("https://www.cvedetails.com/cve/CVE-2019-2099/",
        "https://www.cvedetails.com/cve/CVE-2019-2098/",
        "https://www.cvedetails.com/cve/CVE-2019-2097/",
        "https://www.cvedetails.com/cve/CVE-2019-2096/",
        "https://www.cvedetails.com/cve/CVE-2019-2094/",
        "https://www.cvedetails.com/cve/CVE-2019-2092/")
      if (version == 28) { // 28
        array ++ Array("https://www.cvedetails.com/cve/CVE-2019-2095/",
          "https://www.cvedetails.com/cve/CVE-2019-2093/")
      } else { // 24-27
        array ++ Array("https://www.cvedetails.com/cve/CVE-2019-2091/")
      }
    }

    array
  }
}
