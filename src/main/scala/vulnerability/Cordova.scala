package vulnerability

import tools.VersionComparison.olderThan

object Cordova {

  /**
   * Return a link about security vulnerabilities of the given Cordova version.
   * Based on https://www.cvedetails.com/vulnerability-list/vendor_id-45/product_id-27153/Apache-Cordova.html
   *
   * @param version the Cordova version
   * @return the link
   */
  def getVulnerabilities(version: String): Array[String] = {
    val array = Array[String]()

    if (version == "10.0.0") {
      array :+ "https://www.cvedetails.com/cve/CVE-2021-21315/"
    }
    if (olderThan(version, "6.1.2") == 1) {
      array :+ "https://cordova.apache.org/announcements/2017/01/27/android-612.html"
    }
    if (olderThan(version, "5.2.2") > -1) {
      array :+ "https://lists.apache.org/thread/9z5o5k2pqd9q7oxzxbs2ht6p5kwbr266"
    }
    if (version == "4.1.0") {
      array :+ "https://www.cvedetails.com/cve/CVE-2020-11990/"
    }
    if (olderThan(version, "3.7.2") == 1 || version == "4.0.0" || version == "4.0.1") {
      array :+ "https://www.cvedetails.com/cve/CVE-2015-1835/"
    }
    if (olderThan(version, "3.7.0") == 1) {
      array :+ "https://www.cvedetails.com/cve/CVE-2015-8320/"
    }
    if (olderThan(version, "3.5.1") == 1) {
      array ++ Array("https://www.cvedetails.com/cve/CVE-2014-3502/",
        "https://www.cvedetails.com/cve/CVE-2014-3501/",
        "https://www.cvedetails.com/cve/CVE-2014-3500/")
    }
    if (olderThan(version, "3.3.0") > -1) {
      array ++ Array("https://www.cvedetails.com/cve/CVE-2014-1882/",
        "https://www.cvedetails.com/cve/CVE-2014-1881/",
        "https://www.cvedetails.com/cve/CVE-2012-6637/")
    }

    array
  }
}
