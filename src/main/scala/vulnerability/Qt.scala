package vulnerability

import tools.VersionComparison.olderThan

import scala.collection.mutable.ArrayBuffer

object Qt {

  /**
   * Return a link about security vulnerabilities of the given Qt version.
   * Based on https://www.cvedetails.com/vulnerability-list/vendor_id-6363/QT.html and
   * https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=qt
   *
   * @param version the Qt version
   * @return the link
   */
  def getVulnerabilities(version: String): Array[String] = {
    val array = ArrayBuffer[String]()

    if ((olderThan(version, "5.15.8") > -1)
      || (olderThan("6.0.0", version) > -1 && olderThan(version, "6.2.3") > -1)) {
      array += "https://www.cvedetails.com/cve/CVE-2022-25634/"
    }
    if (version == "5.15.1" || version == "6.0.0" || version == "6.0.2" || version == "6.2.0") {
      array += "https://www.cvedetails.com/cve/CVE-2021-3481/"
    }
    if (olderThan(version, "5.15.0") == 1) {
      array += "https://www.cvedetails.com/cve/CVE-2015-9541/"
    }
    if (olderThan(version, "5.14.2") == 1) {
      array += "https://www.cvedetails.com/cve/CVE-2020-12267/"
    }
    if (olderThan(version, "5.14.1") > -1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-21035"
    }
    if (olderThan(version, "5.14.0") == 1) {
      array += "https://www.cvedetails.com/cve/CVE-2020-24742/"
      array += "https://www.cvedetails.com/cve/CVE-2020-0570/"
    }
    if ((olderThan(version, "5.12.9") > -1)
      || (olderThan("5.13.0", version) > -1 && olderThan(version, "5.15.0") > -1)) {
      array += "https://www.cvedetails.com/cve/CVE-2020-17507/"
    }
    if (olderThan(version, "5.12.2") > -1 && olderThan(version, "5.14.2") > -1) {
      array += "https://www.cvedetails.com/cve/CVE-2020-13962/"
    }
    if (olderThan(version, "5.11.3") == 1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19873"
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19871"
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19870"
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19869"
    }
    if (version.startsWith("5.11")) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19872"
    }
    if ((olderThan("5.9.0", version) > -1 && olderThan(version, "5.15.9") == 1)
      || (olderThan("6.0.0", version) > -1 && olderThan(version, "6.2.4") == 1)) {
      array += "https://www.cvedetails.com/cve/CVE-2021-45930/"
    }
    if ((olderThan("5.7.0", version) > -1 && olderThan(version, "5.11.3") == 1)) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19865"
    }
    if (version.startsWith("5.7")) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-11034"
    }
    if (olderThan(version, "5.5.1") == 1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1290"
    }
    if (olderThan(version, "5.5.0") == 1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-0295"
    }
    if (version.startsWith("5.5")) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-11052"
    }
    if (olderThan(version, "5.3.0") == 1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0190"
    }
    if (olderThan(version, "5.2.0") == 1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4549"
    }
    if ((olderThan("5.0.0", version) > -1 && olderThan(version, "5.15.2") > -1)
      || (olderThan("6.0.0", version) > -1 && olderThan(version, "6.2.1") > -1)) {
      array += "https://www.cvedetails.com/cve/CVE-2021-45930/"
    }
    if ((olderThan("5.0.0", version) > -1 && olderThan(version, "5.15.6") == 1)
      || (olderThan("6.0.0", version) > -1 && olderThan(version, "6.1.2") > -1)) {
      array += "https://www.cvedetails.com/cve/CVE-2021-38593/"
    }
    if ((olderThan("5.0.0", version) > -1 && olderThan(version, "5.11.3") == 1)) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15518"
    }
    if (version.equals("5.0.0") || version.equals("4.4.0")
      || (olderThan("4.8.0", version) > -1 && olderThan(version, "4.8.5") == 1)
      || (olderThan("4.7.0", version) > -1 && olderThan(version, "4.7.6") == 1)) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0254"
    }
    if ((olderThan(version, "4.8.7") == 1)
      || (olderThan("5.0.0", version) > -1 && olderThan(version, "5.4.2") == 1)) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1860"
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1859"
    }
    if (olderThan("4.8.5", version) > -1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4422"
    }
    if (olderThan("4.8.4", version) == 1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5624"
    }
    if (version.equals("4.8.5")) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10040"
    }
    if (version.equals("4.7.4")) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3194"
    }
    if (version.equals("4.6.3")) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2621"
    }
    if (olderThan(version, "4.7.4") == 1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3193"
    }
    if ((olderThan(version, "4.6.5") == 1)
      || (olderThan("4.8.0", version) > -1 && olderThan(version, "4.8.5") == 1)
      || (olderThan("4.7.0", version) > -1 && olderThan(version, "4.7.6") == 1)) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-6093"
    }
    if ((olderThan("4.3.0", version) > -1 && olderThan(version, "4.3.2") > -1)) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5965"
    }
    if (version.startsWith("4")) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25291"
    }
    if (version.equals("3.3.8") || version.equals("4.2.3")) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0242"
    }
    if ((olderThan("3.3.0", version) > -1 && olderThan(version, "3.3.7") == 1)
      || (olderThan("4.1.0", version) > -1 && olderThan(version, "4.1.5") == 1)
      || (olderThan("4.2.0", version) > -1 && olderThan(version, "4.2.1") == 1)) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4811"
    }
    if (olderThan(version, "3.3.4") == 1) {
      array += "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0627"
    }

    array.toArray
  }
}
