package vulnerability

import tools.VersionComparison.olderThan

object Qt {

  /**
   * Return a link about security vulnerabilities of the given Qt version.
   * Based on https://www.cvedetails.com/vulnerability-list/vendor_id-6363/QT.html
   *
   * @param version the Qt version
   * @return the link
   */
  def getVulnerabilities(version: String): Array[String] = {
    val array = Array[String]()

    if ((olderThan(version, "5.15.8") > -1)
      || (olderThan("6.0.0", version) > -1 && olderThan(version, "6.2.3") > -1)) {
      array :+ "https://www.cvedetails.com/cve/CVE-2022-25634/"
    }
    if ((olderThan("5.0.0", version) > -1 && olderThan(version, "5.15.2") > -1)
      || (olderThan("6.0.0", version) > -1 && olderThan(version, "6.2.1") > -1)) {
      array :+ "https://www.cvedetails.com/cve/CVE-2021-45930/"
    }
    if ((olderThan("5.0.0", version) > -1 && olderThan(version, "5.15.6") == 1)
      || (olderThan("6.0.0", version) > -1 && olderThan(version, "6.1.2") > -1)) {
      array :+ "https://www.cvedetails.com/cve/CVE-2021-38593/"
    }
    if (version == "5.15.1" || version == "6.0.0" || version == "6.0.2" || version == "6.2.0") {
      array :+ "https://www.cvedetails.com/cve/CVE-2021-3481/"
    }
    if ((olderThan(version, "5.12.9") > -1)
      || (olderThan("5.13.0", version) > -1 && olderThan(version, "5.15.0") > -1)) {
      array :+ "https://www.cvedetails.com/cve/CVE-2020-17507/"
    }
    if (olderThan(version, "5.12.2") > -1 && olderThan(version, "5.14.2") > -1) {
      array :+ "https://www.cvedetails.com/cve/CVE-2020-13962/"
    }
    if (olderThan(version, "5.15.0") == 1) {
      array :+ "https://www.cvedetails.com/cve/CVE-2015-9541/"
    }
    if (olderThan(version, "5.14.2") == 1) {
      array :+ "https://www.cvedetails.com/cve/CVE-2020-12267/"
    }
    if (olderThan(version, "5.14.0") == 1) {
      array ++ Array("https://www.cvedetails.com/cve/CVE-2020-24742/",
        "https://www.cvedetails.com/cve/CVE-2020-0570/")
    }

    array
  }
}
